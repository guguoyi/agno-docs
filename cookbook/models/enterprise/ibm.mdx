---
title: IBM watsonx
description: Use Granite and Llama models through IBM watsonx.ai.
---

IBM watsonx provides enterprise AI with Granite and open-source models.

```python
from agno.agent import Agent
from agno.models.ibm import WatsonX

agent = Agent(
    model=WatsonX(id="ibm/granite-34b-code-instruct"),
    markdown=True,
)

agent.print_response("Explain enterprise AI governance", stream=True)
```

## Tool Use

```python
from agno.agent import Agent
from agno.models.ibm import WatsonX
from agno.tools.yfinance import YFinanceTools

agent = Agent(
    model=WatsonX(id="ibm/granite-34b-code-instruct"),
    tools=[YFinanceTools(stock_price=True)],
    markdown=True,
)

agent.print_response("What's IBM's stock price?", stream=True)
```

## Structured Output

```python
from pydantic import BaseModel, Field
from agno.agent import Agent
from agno.models.ibm import WatsonX

class CodeReview(BaseModel):
    summary: str = Field(..., description="Review summary")
    issues: list[str] = Field(..., description="Issues found")
    suggestions: list[str] = Field(..., description="Suggestions")

agent = Agent(
    model=WatsonX(id="ibm/granite-34b-code-instruct"),
    output_schema=CodeReview,
)

agent.print_response("Review security best practices for Python applications")
```

## Run Examples

```bash
export WATSONX_API_KEY=xxx
export WATSONX_PROJECT_ID=xxx

git clone https://github.com/agno-agi/agno.git
cd agno/cookbook/90_models/ibm/watsonx

python basic.py
python tool_use.py
```
